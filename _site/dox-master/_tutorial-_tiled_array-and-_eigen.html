<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.17"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>TiledArray: Using TiledArray with Eigen</title>
        <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
        <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
        <script type="text/javascript" src="jquery.smartmenus.js"></script>
        <!-- SmartMenus jQuery Bootstrap Addon -->
        <script type="text/javascript" src="jquery.smartmenus.bootstrap.js"></script>
        <!-- SmartMenus jQuery plugin -->
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">TiledArray 1.0.0-alpha.2</a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Overview</span></a></li>
      <li><a href="userguide.html"><span>User&#160;Guide</span></a></li>
      <li><a href="usergroup0.html"><span>Programmer&#160;Guides</span></a></li>
      <li><a href="usergroup1.html"><span>Source&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Using <a class="el" href="namespace_tiled_array.html">TiledArray</a> with <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="namespace_tiled_array.html">TiledArray</a> has a set of functions that allows you to convert <code>Array</code> object to and from <a href="http://eigen.tuxfamily.org/">Eigen</a> matrix objects. The purpose of these functions is to allow users to quickly prototype <a class="el" href="namespace_tiled_array.html">TiledArray</a> algorithms with inputs from or outputs to <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> matrices.</p>
<p>Because <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> is a non-distributed library, these functions are not appropriate for production code in distributed computing environments. Therefore, these functions will throw an exception if the number of MPI processes is greater than one. If you require conversion of <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> matrices in distributed computing environments, you need to write your own algorithm to collect or distribute matrix data. See the Submatrix Copy section for more information.</p>
<h1>Conversion Functions</h1>
<h2><code><a class="el" href="namespace_tiled_array.html#acc20cb6cde49d2af9af3312a0309f540" title="Convert an Eigen matrix into an Array object.">eigen_to_array()</a></code></h2>
<p>Convert an <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> matrix into an Array object.</p>
<h3>Signature</h3>
<div class="fragment"><div class="line">{c++}</div>
<div class="line">   template&lt;typename A , typename Derived &gt;</div>
<div class="line">   A</div>
<div class="line">   TiledArray::eigen_to_array(madness::World &amp; world,</div>
<div class="line">                              const typename A::trange_type &amp; trange,</div>
<div class="line">                              const Eigen::MatrixBase&lt; Derived &gt; &amp; matrix)</div>
</div><!-- fragment --><h3>Description</h3>
<p>This function will copy the content of <code>matrix</code> into an Array object that is tiled according to the <code>trange</code> object. The copy operation is done in parallel, and this function will block until all elements of <code>matrix</code> have been copied into the result array tiles.</p>
<h4>Template Parameters</h4>
<ul>
<li><code>A</code> The array type</li>
<li><code>Derived</code> The <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> matrix derived type</li>
</ul>
<h4>Parameters</h4>
<ul>
<li><code>world</code> The world where the array will live</li>
<li><code>trange</code> The tiled range of the new array</li>
<li><code>matrix</code> The <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> matrix to be copied</li>
</ul>
<h4>Returns</h4>
<p>An <code>Array</code>, of type <code>A</code>, object that is a copy of matrix</p>
<h4>Exceptions</h4>
<p><code><a class="el" href="class_tiled_array_1_1_exception.html">TiledArray::Exception</a></code> When world size is greater than 1</p>
<h3>Usage</h3>
<div class="fragment"><div class="line">{c++}</div>
<div class="line">   Eigen::MatrixXd matrix(100, 100);</div>
<div class="line">   // Fill matrix with data ...</div>
<div class="line">   </div>
<div class="line">   // Create a tiled range for the new array object</div>
<div class="line">   std::vector&lt;std::size_t&gt; blocks;</div>
<div class="line">   for(std::size_t i = 0ul; i &lt;= 100ul; i += 10ul)</div>
<div class="line">     blocks.push_back(i);</div>
<div class="line">   std::array&lt;TiledArray::TiledRange1, 2&gt; blocks2 =</div>
<div class="line">       {{ TiledArray::TiledRange1(blocks.begin(), blocks.end()),</div>
<div class="line">          TiledArray::TiledRange1(blocks.begin(), blocks.end()) }};</div>
<div class="line">   TiledArray::TiledRange trange(blocks2.begin(), blocks2.end());</div>
<div class="line">   </div>
<div class="line">   // Create an Array from an Eigen matrix.</div>
<div class="line">   TiledArray::Array&lt;double, 2&gt; array = eigen_to_array&lt;TiledArray::Array&lt;double, 2&gt; &gt;(world, trange, matrix);</div>
</div><!-- fragment --><h3>Notes</h3>
<p>This function will only work in non-distributed environments. If you need to convert an <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> matrix to an Array object, you must implement it yourself. However, you may use eigen_submatrix_to_tensor to make writing such an algorithm easier.</p>
<h2><code><a class="el" href="namespace_tiled_array.html#ad4ffc6de9b633a34e7d724191cd11f3f" title="Convert an Array object into an Eigen matrix object.">array_to_eigen()</a></code></h2>
<p>Convert an Array object into an <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> matrix object.</p>
<h3>Signature</h3>
<div class="fragment"><div class="line">{c++}</div>
<div class="line">   template&lt;typename T , unsigned int DIM, typename Tile &gt;</div>
<div class="line">   Eigen::Matrix&lt;T, Eigen::Dynamic, Eigen::Dynamic&gt;</div>
<div class="line">   TiledArray::array_to_eigen(const Array&lt; T, DIM, Tile &gt; &amp; array)</div>
</div><!-- fragment --><h3>Description</h3>
<p>This function will block until all tiles of array have been set and copied into the new <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> matrix. Usage:</p>
<h3>Template Parameters</h3>
<ul>
<li><code>T</code> The element type of the array</li>
<li><code>DIM</code> The array dimension</li>
<li><code>Tile</code> The tile type of the array</li>
</ul>
<h4>Parameters</h4>
<ul>
<li><code>array</code> The array to be converted</li>
</ul>
<h4>Exceptions</h4>
<p><code><a class="el" href="class_tiled_array_1_1_exception.html">TiledArray::Exception</a></code> When world size is greater than 1</p>
<h4>Usage</h4>
<div class="fragment"><div class="line">{c++}</div>
<div class="line">   TiledArray::Array&lt;double, 2&gt; array(world, trange);</div>
<div class="line">   // Set tiles of array ...</div>
<div class="line">   Eigen::MatrixXd m = array_to_eigen(array);</div>
</div><!-- fragment --><h3>Note</h3>
<p>This function will only work in non-distributed environments. If you need to convert an Array object to an <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> matrix, you must implement it yourself. However, you may use eigen_submatrix_to_tensor to make writing such an algorithm easier.</p>
<h1><a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> Interface</h1>
<p><a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> includes a map class which allows external libraries to work with <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a>. <a class="el" href="namespace_tiled_array.html">TiledArray</a> provides a set of functions for wrapping <code>Tensor</code> object with <a class="el" href="class_eigen_1_1_map.html">Eigen::Map</a>. These map objects may be used as normal <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> matrices or vectors.</p>
<h2><code><a class="el" href="namespace_tiled_array.html#ad8ea8180e5c13c6da262d4572bfc5aa2" title="Construct a const Eigen::Map object for a given Tensor object.">eigen_map()</a></code></h2>
<p>Construct an <code>m x n</code> <code><a class="el" href="class_eigen_1_1_map.html">Eigen::Map</a></code> object for a given <code>Tensor</code> object.</p>
<h3>Signature</h3>
<div class="fragment"><div class="line">{c++}</div>
<div class="line">   template &lt;typename T, typename A&gt;</div>
<div class="line">   inline Eigen::Map&lt;const Eigen::Matrix&lt;T, Eigen::Dynamic, Eigen::Dynamic, Eigen::RowMajor&gt;, Eigen::AutoAlign&gt;</div>
<div class="line">   eigen_map(const Tensor&lt;T, A&gt;&amp; tensor, const std::size_t m, const std::size_t n)</div>
<div class="line"> </div>
<div class="line">   template &lt;typename T, typename A&gt;</div>
<div class="line">   inline Eigen::Map&lt;Eigen::Matrix&lt;T, Eigen::Dynamic, Eigen::Dynamic, Eigen::RowMajor&gt;, Eigen::AutoAlign&gt;</div>
<div class="line">   eigen_map(Tensor&lt;T, A&gt;&amp; tensor, const std::size_t m, const std::size_t n)</div>
</div><!-- fragment --><h3>Description</h3>
<p>This function will wrap a <code>tensor</code> in an <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> map object. This object may be used in expressions with other <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> objects. See <a href="http://eigen.tuxfamily.org/dox/TutorialMapClass.html">Eigen documentation</a> for more details on Map objects.</p>
<h4>Template Parameters</h4>
<ul>
<li><code>T</code> The tensor element type</li>
<li><code>A</code> The tensor allocator type</li>
</ul>
<h4>Parameters</h4>
<ul>
<li><code>tensor</code> The tensor object</li>
<li><code>m</code> The number of rows in the result matrix</li>
<li><code>n</code> The number of columns in the result matrix</li>
</ul>
<h4>Returns</h4>
<p>An m x n <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> matrix map for <code>tensor</code></p>
<h4>Exceptions</h4>
<p><code><a class="el" href="class_tiled_array_1_1_exception.html">TiledArray::Exception</a></code> When <code>m * n</code> is not equal to <code>tensor</code> size.</p>
<h3>Usage</h3>
<div class="fragment"><div class="line">{c++}</div>
<div class="line">   // Construct a tensor object</div>
<div class="line">   std::array&lt;std::size_t, 2&gt; size = {{ 10, 10 }};</div>
<div class="line">   TiledArray::Tensor&lt;int&gt; tensor(TiledArray::Range(size), 1);</div>
<div class="line">   </div>
<div class="line">   // Construct an Eigen matrix</div>
<div class="line">   Eigen::MatrixXi matrix(10, 10);</div>
<div class="line">   matrix.fill(1);</div>
<div class="line"> </div>
<div class="line">   // Intialize an Eigen Matrix with a TiledArray tensor.</div>
<div class="line">   Eigen::MatrixXi x = matrix + TiledArray::eigen_map(tensor, 10, 10);</div>
</div><!-- fragment --><h3>Note</h3>
<p>The dimensions <code>m</code> and <code>n</code> do not have to match the dimensions of the tensor object, but they size of the tensor must be equal to the size of the resulting <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> map object.</p>
<h2><a class="el" href="namespace_tiled_array.html#ad8ea8180e5c13c6da262d4572bfc5aa2" title="Construct a const Eigen::Map object for a given Tensor object.">eigen_map()</a></h2>
<p>Construct a <code><a class="el" href="class_eigen_1_1_map.html">Eigen::Map</a></code> object for a given <code>Tensor</code> object.</p>
<h3>Signature</h3>
<div class="fragment"><div class="line">{c++}</div>
<div class="line">   template &lt;typename T, typename A&gt;</div>
<div class="line">   inline Eigen::Map&lt;const Eigen::Matrix&lt;T, Eigen::Dynamic, Eigen::Dynamic, Eigen::RowMajor&gt;, Eigen::AutoAlign&gt;</div>
<div class="line">   eigen_map(const Tensor&lt;T, A&gt;&amp; tensor)</div>
<div class="line"> </div>
<div class="line">   template &lt;typename T, typename A&gt;</div>
<div class="line">   inline Eigen::Map&lt;Eigen::Matrix&lt;T, Eigen::Dynamic, Eigen::Dynamic, Eigen::RowMajor&gt;, Eigen::AutoAlign&gt;</div>
<div class="line">   eigen_map(Tensor&lt;T, A&gt;&amp; tensor)</div>
</div><!-- fragment --><h3>Description</h3>
<p>This function will wrap a <code>tensor</code> in an <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> map object. This object may be used in expressions with other <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> objects. See [<a href="http://eigen.tuxfamily.org/dox/TutorialMapClass.html">http://eigen.tuxfamily.org/dox/TutorialMapClass.html</a> <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> documentation] for more details on Map objects.</p>
<h4>Template Parameters</h4>
<ul>
<li><code>T</code> The tensor element type</li>
<li><code>A</code> The tensor allocator type</li>
</ul>
<h4>Parameters</h4>
<ul>
<li><code>tensor</code> The tensor object</li>
</ul>
<h4>Returns</h4>
<p>An <a class="el" href="namespace_eigen.html" title="Forward declarations.">Eigen</a> matrix map for <code>tensor</code> where the number of rows and columns of the matrix match the dimension sizes of the tensor object.</p>
<h4>Exceptions</h4>
<p><code><a class="el" href="class_tiled_array_1_1_exception.html">TiledArray::Exception</a></code> When <code>tensor</code> dimensions are not equal to 2 or 1.</p>
<h4>Usage</h4>
<div class="fragment"><div class="line">{c++}</div>
<div class="line">   // Construct a tensor object</div>
<div class="line">   std::array&lt;std::size_t, 2&gt; size = {{ 10, 10 }};</div>
<div class="line">   TiledArray::Tensor&lt;int&gt; tensor(TiledArray::Range(size), 1);</div>
<div class="line">   </div>
<div class="line">   // Construct an Eigen matrix</div>
<div class="line">   Eigen::MatrixXi matrix(10, 10);</div>
<div class="line">   matrix.fill(1);</div>
<div class="line">   </div>
<div class="line">   // Intialize an Eigen Matrix with a TiledArray tensor.</div>
<div class="line">   Eigen::MatrixXi x = matrix + TiledArray::eigen_map(tensor);</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->

<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
    Generated at Wed Mar 4 2020 15:58:00 for <a href="https://https://github.com/ValeevGroup/tiledarray/">TiledArray</a>
    1.0.0-alpha.2 by &#160;<a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
<script type="text/javascript" src="doxy-boot.js"></script>
</html>
